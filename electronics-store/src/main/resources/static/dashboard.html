<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Electronics Store ‚Äî –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</title>
    <link rel="stylesheet" href="/css/app.css">
</head>
<body>
<div class="layout">
    <aside class="sidebar">
        <div class="logo">
            <span class="logo-dot"></span>
            <span>Electronics Store</span>
        </div>
        <nav class="sidebar-nav">
            <a class="nav-link active" href="/dashboard.html">
                <span class="nav-link-icon">üè†</span>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </a>
            <a class="nav-link" href="/categories.html">
                <span class="nav-link-icon">üìÅ</span>
                <span>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
            </a>
            <a class="nav-link" href="/products.html">
                <span class="nav-link-icon">üíª</span>
                <span>–¢–æ–≤–∞—Ä—ã</span>
            </a>
            <a class="nav-link" href="/orders.html">
                <span class="nav-link-icon">üßæ</span>
                <span>–ó–∞–∫–∞–∑—ã</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <div>API: <span class="tag">Spring Boot + PostgreSQL</span></div>
        </div>
    </aside>
    <main class="main">
        <header class="main-header">
            <div>
                <div class="main-title" id="titleDashboard">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
                <div class="main-subtitle" id="subtitleDashboard">–°–≤–æ–¥–∫–∞ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É –∏ –∑–∞–∫–∞–∑–∞–º</div>
            </div>
            <div style="display:flex;align-items:center;gap:8px;">
                <button class="btn btn-ghost" id="langToggle">RU</button>
            </div>
        </header>
        <div class="content">
            <section class="cards-row">
                <article class="card">
                    <div class="card-header">
                        <div>
                            <div class="card-title" id="cardCategoriesTitle">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
                            <div class="card-value" id="statCategories">‚Äî</div>
                        </div>
                    </div>
                    <div class="card-actions">
                        <a class="btn btn-secondary" href="/categories.html">–û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑–¥–µ–ª</a>
                    </div>
                </article>
                <article class="card">
                    <div class="card-header">
                        <div>
                            <div class="card-title" id="cardProductsTitle">–¢–æ–≤–∞—Ä—ã</div>
                            <div class="card-value" id="statProducts">‚Äî</div>
                        </div>
                    </div>
                    <div class="card-actions">
                        <a class="btn btn-secondary" href="/products.html">–û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥</a>
                    </div>
                </article>
                <article class="card">
                    <div class="card-header">
                        <div>
                            <div class="card-title" id="cardOrdersTitle">–ó–∞–∫–∞–∑—ã</div>
                            <div class="card-value" id="statOrders">‚Äî</div>
                        </div>
                    </div>
                    <div class="card-actions">
                        <a class="btn btn-secondary" href="/orders.html">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–∫–∞–∑–∞–º</a>
                    </div>
                </article>
            </section>

            <section class="grid-two">
                <article class="card">
                    <div class="section-title-row">
                        <div class="card-title" id="recentOrdersTitle">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</div>
                        <button class="btn btn-ghost" id="refreshDashboardOrders">–û–±–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                    <div class="table-wrapper" style="max-height: 260px;">
                        <table>
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>–ö–ª–∏–µ–Ω—Ç</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–°—É–º–º–∞</th>
                                <th>–î–∞—Ç–∞</th>
                            </tr>
                            </thead>
                            <tbody id="dashboardOrdersBody">
                            <tr><td colspan="5" class="muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>
                            </tbody>
                        </table>
                    </div>
                </article>
                <article class="card">
                    <div class="section-title-row">
                        <div class="card-title" id="quickActionsTitle">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</div>
                    </div>
                    <div class="content">
                        <button class="btn" id="btnGoCategories" onclick="location.href='/categories.html'">
                            üìÅ –ü–µ—Ä–µ–π—Ç–∏ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
                        </button>
                        <button class="btn" id="btnGoProducts" onclick="location.href='/products.html'">
                            üíª –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
                        </button>
                        <button class="btn" id="btnGoOrders" onclick="location.href='/orders.html'">
                            üßæ –°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–∫–∞–∑—ã
                        </button>
                    </div>
                </article>
            </section>
        </div>
    </main>
</div>

<script src="/js/api.js"></script>
<script>
    const dashboardTexts = {
        ru: {
            title: '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è',
            subtitle: '–°–≤–æ–¥–∫–∞ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É –∏ –∑–∞–∫–∞–∑–∞–º',
            categories: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏',
            products: '–¢–æ–≤–∞—Ä—ã',
            orders: '–ó–∞–∫–∞–∑—ã',
            recentOrders: '–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã',
            quickActions: '–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è',
            goCategories: 'üìÅ –ü–µ—Ä–µ–π—Ç–∏ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏',
            goProducts: 'üíª –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤',
            goOrders: 'üßæ –°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–∫–∞–∑—ã',
            noOrders: '–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç'
        },
        en: {
            title: 'Dashboard',
            subtitle: 'Catalog and orders overview',
            categories: 'Categories',
            products: 'Products',
            orders: 'Orders',
            recentOrders: 'Recent orders',
            quickActions: 'Quick actions',
            goCategories: 'üìÅ Manage categories',
            goProducts: 'üíª Open product catalog',
            goOrders: 'üßæ Create and view orders',
            noOrders: 'No orders yet'
        }
    };

    function applyDashboardLang(lang) {
        const t = dashboardTexts[lang];
        document.getElementById('titleDashboard').textContent = t.title;
        document.getElementById('subtitleDashboard').textContent = t.subtitle;
        document.getElementById('cardCategoriesTitle').textContent = t.categories;
        document.getElementById('cardProductsTitle').textContent = t.products;
        document.getElementById('cardOrdersTitle').textContent = t.orders;
        document.getElementById('recentOrdersTitle').textContent = t.recentOrders;
        document.getElementById('quickActionsTitle').textContent = t.quickActions;
        document.getElementById('btnGoCategories').textContent = t.goCategories;
        document.getElementById('btnGoProducts').textContent = t.goProducts;
        document.getElementById('btnGoOrders').textContent = t.goOrders;
    }

    async function loadStats() {
        try {
            const [categories, products, orders] = await Promise.all([
                apiGet('/api/categories'),
                apiGet('/api/products'),
                apiGet('/api/orders')
            ]);
            document.getElementById('statCategories').textContent = categories.length;
            document.getElementById('statProducts').textContent = products.length;
            document.getElementById('statOrders').textContent = orders.length;
            renderDashboardOrders(orders);
        } catch (e) {
            console.error(e);
        }
    }

    function renderDashboardOrders(orders) {
        const body = document.getElementById('dashboardOrdersBody');
        body.innerHTML = '';
        const t = dashboardTexts[CURRENT_LANG];
        if (!orders || orders.length === 0) {
            body.innerHTML = `<tr><td colspan="5" class="muted">${t.noOrders}</td></tr>`;
            return;
        }
        const last = [...orders].slice(-5).reverse();
        for (const o of last) {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${o.id}</td>
                <td>${o.customerName}</td>
                <td><span class="badge ${badgeClassForStatus(o.status)}">${o.status}</span></td>
                <td>${formatMoney(o.total)}</td>
                <td>${(o.createdAt || '').replace('T', ' ').slice(0, 16)}</td>
            `;
            body.appendChild(tr);
        }
    }

    function badgeClassForStatus(status) {
        switch (status) {
            case 'PAID': return 'badge-success';
            case 'CANCELED': return 'badge-danger';
            default: return 'badge-warning';
        }
    }

    document.getElementById('refreshDashboardOrders').addEventListener('click', loadStats);

    initLanguageToggle(applyDashboardLang);
    loadStats();
</script>
</body>
</html>


